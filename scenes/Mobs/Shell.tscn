[gd_scene format=3 uid="uid://elmpcqsoarjp"]

[ext_resource type="PackedScene" uid="uid://b4512qioi3g1i" path="res://scenes/Gravity.tscn" id="2_6sbjw"]
[ext_resource type="PackedScene" uid="uid://bxerqeybhhs0c" path="res://scenes/Mobs/state_machine.tscn" id="5_e6lbg"]
[ext_resource type="Script" uid="uid://b7oh0gjgvjexb" path="res://scripts/PJ/state_machine/AI_controller.gd" id="6_ajbgq"]
[ext_resource type="Script" uid="uid://dkukaamdo4acb" path="res://scripts/PJ/state_machine/Shell_behaviour.gd" id="6_raqt8"]
[ext_resource type="Script" uid="uid://ws43rxsp8qki" path="res://scripts/PJ/state_machine/States/Patrol.gd" id="7_ayt5m"]
[ext_resource type="Script" uid="uid://b7ydidx4polw6" path="res://scripts/Valk/shell_disappearance.gd" id="9_jt8f1"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_lj2st"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_nyxyb"]
transparency = 1
albedo_color = Color(0, 0.6156863, 0.3254902, 1)

[sub_resource type="CapsuleMesh" id="CapsuleMesh_ajbgq"]
material = SubResource("StandardMaterial3D_nyxyb")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_re4yq"]
transparency = 1
albedo_color = Color(0.27935672, 0.27935672, 0.27935672, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_ayt5m"]
albedo_color = Color(0.05278877, 0.33988103, 0, 1)

[sub_resource type="BoxMesh" id="BoxMesh_lqxc7"]
material = SubResource("StandardMaterial3D_ayt5m")
size = Vector3(0.2, 0.2, 0.2)

[node name="Shell" type="CharacterBody3D" unique_id=2079833793]
collision_layer = 8
collision_mask = 7

[node name="CollisionShape3D" type="CollisionShape3D" parent="." unique_id=58911616]
shape = SubResource("CapsuleShape3D_lj2st")

[node name="MeshInstance3D" type="MeshInstance3D" parent="." unique_id=1510776867]
mesh = SubResource("CapsuleMesh_ajbgq")
surface_material_override/0 = SubResource("StandardMaterial3D_re4yq")

[node name="Gravity" parent="." unique_id=1429912289 node_paths=PackedStringArray("_body") instance=ExtResource("2_6sbjw")]
_body = NodePath("..")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="." unique_id=5614037]
path_postprocessing = 1
debug_enabled = true
debug_path_custom_color = Color(0.95686275, 0.13333334, 0.23137255, 1)
script = ExtResource("6_ajbgq")

[node name="Shell Disappearance" type="Node" parent="." unique_id=658173647 node_paths=PackedStringArray("shell_mesh")]
script = ExtResource("9_jt8f1")
shell_mesh = NodePath("../MeshInstance3D")

[node name="State_machine" parent="." unique_id=593020358 node_paths=PackedStringArray("mob", "nav_agent") instance=ExtResource("5_e6lbg")]
mob = NodePath("..")
nav_agent = NodePath("../NavigationAgent3D")

[node name="Follow_player" parent="State_machine" index="1"]
state_type = 1

[node name="Attack" parent="State_machine" index="2"]
move_speed = 10.0
state_type = 4

[node name="Follow_sound" parent="State_machine" index="3" node_paths=PackedStringArray("follow_target")]
follow_target = NodePath("Empty_target")
state_type = 2

[node name="Searching" parent="State_machine" index="4"]
searching_radius = 3.0
move_speed = 5.0
state_type = 3

[node name="Behaviour" parent="State_machine" index="5" node_paths=PackedStringArray("sound_target", "state_machine")]
script = ExtResource("6_raqt8")
follow_state_duration = 5.0
searching_time = 5.0
follow_sound_state_duration = 2.0
sound_target = NodePath("../Follow_sound/Empty_target")
hearing_range = 10.0
wander_time = 10.0
patrol_time = 10.0
state_machine = NodePath("..")

[node name="Patrol" type="Node" parent="State_machine" unique_id=1952931126 node_paths=PackedStringArray("empty_target")]
script = ExtResource("7_ayt5m")
empty_target = NodePath("empty_target")
metadata/_custom_type_script = "uid://foywhiftl87x"

[node name="empty_target" type="Node3D" parent="State_machine/Patrol" unique_id=571049646]

[node name="MeshInstance3D" type="MeshInstance3D" parent="State_machine/Patrol/empty_target" unique_id=751999632]
mesh = SubResource("BoxMesh_lqxc7")

[editable path="State_machine"]
